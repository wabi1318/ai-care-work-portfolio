# ケアスキル判定アプリ 技術選定（MVP 版）

---

## 1. 概要

ハッカソンで開発する「ケアスキル判定アプリ」の最小実用プロトタイプ（MVP）を、**Next.js + Node.js** を基盤としたモダンなフルスタック構成で実装します。本資料は現時点の技術選定を整理し、今後編集しながら意思決定を深めるためのドキュメントです。

---

## 2. 全体アーキテクチャ

```
┌────────────┐       ┌────────────────────────────┐
│   ユーザー    │  ⇆   │   フロントエンド (Next.js)   │
└────────────┘       │ • React 18 / App Router      │
                      │ • Tailwind CSS (任意)        │
                      └────────┬───────────────────────┘
                               │ API Routes (Node.js)
                               ▼
                      ┌────────────────────────────┐
                      │     バックエンド (Node.js)   │
                      │ • API Routes or Express     │
                      │ • Auth.js / Clerk           │
                      │ • OpenAI GPT‑4 Turbo        │
                      │ • PostgreSQL (Supabase)     │
                      └────────┬───────────────────────┘
                               │
                               ▼
                      ┌────────────────────────────┐
                      │        Supabase DB          │
                      └────────────────────────────┘
```

---

## 3. 技術スタック一覧

| レイヤ           | 採用技術                                      | 理由・補足                                                                  |
| ---------------- | --------------------------------------------- | --------------------------------------------------------------------------- |
| **フロント**     | **Next.js 14 (React 18)**                     | App Router によるファイルベースルーティング、SSG/SSR、Edge Functions 対応。 |
|                  | **Zod + react‑hook‑form**                     | 型安全なスキーマ定義と軽量フォーム制御を両立。                              |
|                  | Tailwind CSS (任意)                           | ユーティリティファーストで迅速なUI開発。                                    |
| **バックエンド** | **Node.js 20 (Next.js API Routes)**           | 同一リポジトリで API を実装でき、デプロイがシンプル。                       |
|                  | Express または tRPC (将来的)                  | ルーティング/型安全 RPC を必要に応じ追加。                                  |
| **認証**         | **Auth.js (NextAuth.js v5)** または **Clerk** | OAuth・メールログインの即時導入。                                           |
| **データベース** | **Supabase (PostgreSQL)**                     | DB・Auth・ストレージを一体で提供、無料枠あり。                              |
| **LLM**          | **OpenAI GPT‑4o-mini**                        | 価格/性能バランス・SDK充実。将来的に **Claude 3** 追加を検討。              |
| **インフラ**     | **Vercel**                                    | Next.js に最適化されたホスティング、Preview Deploy。                        |
| **CI/CD**        | GitHub Actions                                | lint/test/deploy を自動化。                                                 |

---

## 4. LLM API 比較

| 項目             | GPT‑4 Turbo (OpenAI)     | Claude 3 Opus (Anthropic) |
| ---------------- | ------------------------ | ------------------------- |
| 料金 (目安)      | \$0.01 / 1K input tokens | \$0.015 / 1K input tokens |
| 最大コンテキスト | 128K tokens              | 200K tokens (Haiku)       |
| 日本語性能       | ◎                        | ◎〜○                      |
| SDK・資料        | 豊富 (openai npm)        | 少なめ (HTTP API)         |
| フォーマット制御 | 得意 (JSON mode 等)      | やや慎重反応              |
| 商用許諾         | 明確・広範               | 国/地域で制限に注意       |

> **選定理由:** MVP では実装速度と開発者体験を優先し **OpenAI GPT‑4 Turbo** を採用。長文の読解性能やトークンコスト要件が変われば Claude 3 も検討する。

---

## 5. 今後の課題・検討ポイント

1. **スキーマ設計**

   - ケア行動のエンティティ定義と正規化 (ER 図作成)

2. **LLM プロンプト設計**

   - JSON 出力スキーマを固定し、評価項目ごとの重み付けを検証

3. **セキュリティ**

   - API キー管理 (Vercel env) と Rate Limit、守秘データの取り扱い

4. **モニタリング**

   - OpenAI Usage API ＆ Supabase テレメトリでトークン/コスト可視化

5. **UX 改善**

   - 入力負荷削減 (テンプレート、音声入力等) や説明生成の精度向上

---

### 更新履歴

- 2025‑04‑30 : 初版作成（Next.js + Node.js 構成）

> **編集ガイド:**
>
> - 追記・修正は自由です。大項目を増やすときは `##` 見出しを使用してください。
> - 比較表の数値や SDK 情報は API アップデートに合わせて随時更新をお願いします。
